# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## What This Is

This is the marketing and documentation website for **Q-Tune** — a DIY chromatic guitar tuner pedal kit based on an ESP32-S3 microcontroller. The site is hosted at [q-tune.com](https://www.q-tune.com) and also serves as the firmware OTA update portal via ESP Web Tools. Built with **Astro** + **Tailwind CSS**, deployed to GitHub Pages via GitHub Actions.

## Commands

```bash
# Install dependencies
npm install

# Dev server with hot reload
npm run dev

# Production build
npm run build

# Preview production build locally
npm run preview
```

The site builds to `dist/` (gitignored).

## Architecture

### Tech Stack

- **Astro** — static site generator
- **Tailwind CSS** — utility-first CSS with `@tailwindcss/typography` for prose
- **TypeScript** — strict mode
- **GitHub Actions** — CI/CD deployment to GitHub Pages

### Project Structure

- **`src/pages/`** — All site pages. `.astro` for component pages, `.md` for legal/prose pages.
- **`src/layouts/`** — `BaseLayout.astro` (HTML shell), `PageLayout.astro` (content pages with title banner + prose), `HomeLayout.astro` (full-bleed passthrough).
- **`src/components/`** — Reusable Astro components (Header, Footer, SEOHead, FirmwareInstaller, BuyButton, etc.).
- **`src/data/`** — TypeScript data files: `navigation.ts`, `products.ts`, `features.ts`, `faq.ts`.
- **`src/styles/global.css`** — Tailwind directives and base theme overrides.
- **`public/`** — Static assets served as-is at their URL paths.
- **`public/assets/install/`** — Firmware distribution system (see below).

### Design System

Dark/moody pedal-culture aesthetic:
- Background: `#0a0a0f` (near-black), surfaces: `#12121a`, `#1a1a26`, `#252535`
- Accent: `#d4a054` (warm amber/gold)
- Text: `#e8e6e3` (body), `#f5f3f0` (headings), `#9a9aaa` (muted)
- Fonts: Outfit (headings), Inter (body), JetBrains Mono (technical)

### Firmware OTA Updates

The `public/assets/install/` directory is the firmware distribution system:

- **`artifacts/manifest.json`** — Points to the current production firmware version.
- **`artifacts/*.bin`** — Production firmware binaries.
- **`beta/`** — Beta firmware binaries + per-version manifest JSON files.

**To release a new firmware version:**
1. Add the new `q-tune-<version>.bin` to `public/assets/install/artifacts/`
2. Update `public/assets/install/artifacts/manifest.json` to point to the new binary and update the `version` field.

**To release a beta firmware version:**
1. Add `q-tune-<version>.bin` to `public/assets/install/beta/`
2. Create `public/assets/install/beta/manifest-<version>.json`
3. Redeploy — the `BetaVersionPicker` component auto-discovers all `q-tune-*.bin` files in `beta/` at build time via `fs.readdirSync`.

### Buy Buttons

Purchase links use Stripe's hosted checkout. Product data (names, prices, Stripe URLs) lives in `src/data/products.ts`. A `RegionModal` component intercepts buy button clicks and redirects to the Stripe URL for the selected region.

### Key External Dependencies

- **ESP Web Tools** — loaded from unpkg CDN on install pages for in-browser ESP32 flashing.
- **Stripe** — payment processing via hosted checkout URLs.
- **Google Analytics** — tag `G-CVGF0BKRZD` via `GoogleAnalytics.astro` component.
- **Kit.com** — newsletter signup embed on homepage.

### Git Commits

- Never include `Co-Authored-By` or any Claude/AI attribution in commit messages.

### SEO

- Product schema (JSON-LD) on homepage
- FAQPage schema on FAQ page
- Per-page meta tags via `SEOHead.astro` component
- Sitemap auto-generated by `@astrojs/sitemap` (excludes `/beta-install/`)
- `robots.txt` in `public/` disallows `/beta-install/`
